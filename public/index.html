<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Medal</title>
    <meta charset="utf-8" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Arvo:ital,wght@0,400;0,700;1,400;1,700&family=Onest:wght@100..900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" type="text/css" href="/css/main.css" />
  </head>

  <body>
    <div class="wrapper">
      <!-- SLIDE 1 -->
      <div class="card card--1">
        <div class="card__header">

          <div class="card__logo card__will-animate">
            <strong>m</strong>edal
          </div>
          <h1 class="card__title card__will-animate">
            <u>rock climbers</u>, connected.
          </h1>
        </div>

        <div class="card__body card__img--1">
          <span class="card__subtitle card__will-animate">rock climbing</span>
        </div>

        <div class="card__image card__will-animate">
          <!--<img
            src=""
            alt="screen"
            class=""
          />-->
          </div>

      </div>

      <!-- SLIDE 2 -->
      <div class="card card--2">
        <div class="card__header">

          <div class="card__logo card__will-animate">
            <strong>m</strong>edal
          </div>
          <h1 class="card__title card__will-animate">
            <u>rock climbers</u>, connected.
          </h1>
        </div>

        <div class="card__body card__img--2">
          <span class="card__subtitle card__will-animate">rock climbing</span>
        </div>

        <div class="card__image card__will-animate">
          <!--<img
            src=""
            alt="screen"
            class=""
          />-->
          </div>

      </div>
      <!-- SLIDE 3 -->
      <div class="card card--3">
        <div class="card__header">

          <div class="card__logo card__will-animate">
            <strong>m</strong>edal
          </div>
          <h1 class="card__title card__will-animate">
            <u>rock climbers</u>, connected.
          </h1>
        </div>

        <div class="card__body card__img--3">
          <span class="card__subtitle card__will-animate">rock climbing</span>
        </div>

        <div class="card__image card__will-animate">
          <!--<img
            src=""
            alt="screen"
            class=""
          />-->
          </div>

      </div>

      <!-- SLIDE 4 -->
     <div class="card card--4">
        <div class="card__header">

          <div class="card__logo card__will-animate">
            <strong>m</strong>edal
          </div>
          <h1 class="card__title card__will-animate">
            <u>rock climbers</u>, connected.
          </h1>
        </div>

        <div class="card__body card__img--4">
          <span class="card__subtitle card__will-animate">rock climbing</span>
        </div>

        <div class="card__image card__will-animate">
          <!--<img
            src=""
            alt="screen"
            class=""
          />-->
          </div>

      </div>

    <!-- /wrapper -->

    <!-- bullets -->
    <div class="cards-placeholder">
      <div class="cards-placeholder__item"></div>
      <div class="cards-placeholder__item"></div>
      <div class="cards-placeholder__item"></div>
      <div class="cards-placeholder__item"></div>
    </div>

    <!-- Main JS -->
    <script>
      (function () {
        "use strict";

        var BODY_BACKGROUNDS = ["#1C2229", "#FDF06F", "#1C2229", "#FDF06F"];

        function Slider() {
          this.cards = document.querySelectorAll(".card");
          this.currentIndex = 0;

          this.isDragging = false;
          this.startX = 0;
          this.currentX = 0;

          this.initEvents();
          this.setActivePlaceholder();
        }

        // initialize drag events
        Slider.prototype.initEvents = function () {
          document.addEventListener("touchstart", this.onStart.bind(this));
          document.addEventListener("touchmove", this.onMove.bind(this));
          document.addEventListener("touchend", this.onEnd.bind(this));

          document.addEventListener("mousedown", this.onStart.bind(this));
          document.addEventListener("mousemove", this.onMove.bind(this));
          document.addEventListener("mouseup", this.onEnd.bind(this));
        };

        // set active placeholder
        Slider.prototype.setActivePlaceholder = function () {
          var placeholders = document.querySelectorAll(
            ".cards-placeholder__item"
          );
          var activePlaceholder = document.querySelector(
            ".cards-placeholder__item--active"
          );

          if (activePlaceholder) {
            activePlaceholder.classList.remove(
              "cards-placeholder__item--active"
            );
          }

          placeholders[this.currentIndex].classList.add(
            "cards-placeholder__item--active"
          );

          var bodyEl = document.querySelector("body");
          bodyEl.style.backgroundColor = BODY_BACKGROUNDS[this.currentIndex];
        };

        // mousedown event
        Slider.prototype.onStart = function (evt) {
          this.isDragging = true;

          this.currentX = evt.pageX || evt.touches[0].pageX;
          this.startX = this.currentX;

          var card = this.cards[this.currentIndex];

          // calculate ration to use in parallax effect
          this.windowWidth = window.innerWidth;
          this.cardWidth = card.offsetWidth;
          this.ratio = this.windowWidth / (this.cardWidth / 10);
        };

        // mouseup event
        Slider.prototype.onEnd = function (evt) {
          this.isDragging = false;

          var diff = this.startX - this.currentX;
          var direction = diff > 0 ? "left" : "right";
          this.startX = 0;

          if (Math.abs(diff) > this.windowWidth / 8) { // <-- this value sets lenght of the drag to trigger next slide
            if (direction === "left") {
              this.slideLeft();
            } else if (direction === "right") {
              this.slideRight();
            } else {
              this.cancelMoveCard();
            }
          } else {
            this.cancelMoveCard();
          }
        };

        // mousemove event
        Slider.prototype.onMove = function (evt) {
          if (!this.isDragging) return;

          this.currentX = evt.pageX || evt.touches[0].pageX;
          var diff = this.startX - this.currentX;
          diff *= -1;

          // don't let drag way from the center more than half of window
          if (Math.abs(diff) > this.windowWidth / 2) {
            if (diff > 0) {
              diff = this.windowWidth / 2;
            } else {
              diff = -this.windowWidth / 2;
            }
          }

          this.moveCard(diff);
        };

        // slide to left direction
        Slider.prototype.slideLeft = function () {
          // if last don't do nothing
          if (this.currentIndex === this.cards.length - 1) {
            this.cancelMoveCard();
            return;
          }

          var self = this;
          var card = this.cards[this.currentIndex];
          var cardWidth = this.windowWidth / 2;

          card.style.left = "-50%";

          this.resetCardElsPosition();

          this.currentIndex += 1;
          this.setActivePlaceholder();
          card = this.cards[this.currentIndex];

          card.style.left = "50%";

          this.moveCardEls(cardWidth * 3);

          // add delay to resetting position
          setTimeout(function () {
            self.resetCardElsPosition();
          }, 50);
        };

        // slide to right direction
        Slider.prototype.slideRight = function () {
          // if last don't do nothing
          if (this.currentIndex === 0) {
            this.cancelMoveCard();
            return;
          }

          var self = this;
          var card = this.cards[this.currentIndex];
          var cardWidth = this.windowWidth / 2;

          card.style.left = "150%";

          this.resetCardElsPosition();

          this.currentIndex -= 1;
          this.setActivePlaceholder();
          card = this.cards[this.currentIndex];

          card.style.left = "50%";

          this.moveCardEls(-cardWidth * 3);

          // add delay to resetting position
          setTimeout(function () {
            self.resetCardElsPosition();
          }, 50);
        };

        // put active card in original position (center)
        Slider.prototype.cancelMoveCard = function () {
          var self = this;
          var card = this.cards[this.currentIndex];

          card.style.transition = "transform 0.5s ease-out";
          card.style.transform = "";

          this.resetCardElsPosition();
        };

        // reset to original position elements of card
        Slider.prototype.resetCardElsPosition = function () {
          var self = this;
          var card = this.cards[this.currentIndex];

          var cardLogo = card.querySelector(".card__logo");
          var cardTitle = card.querySelector(".card__title");
          var cardSubtitle = card.querySelector(".card__subtitle");
          var cardImage = card.querySelector(".card__image");
          var cardWillAnimate = card.querySelectorAll(".card__will-animate");

          // move card elements to original position
          cardWillAnimate.forEach(function (el) {
            el.style.transition = "transform 0.5s ease-out";
          });

          cardLogo.style.transform = "";

          cardTitle.style.transform = "";
          cardSubtitle.style.transform = "";

          cardImage.style.transform = "";

          // clear transitions
          setTimeout(function () {
            card.style.transform = "";
            card.style.transition = "";

            cardWillAnimate.forEach(function (el) {
              el.style.transition = "";
            });
          }, 500);
        };

        // slide card while dragging
        Slider.prototype.moveCard = function (diff) {
          var card = this.cards[this.currentIndex];

          card.style.transform = "translateX(calc(" + diff + "px - 50%))";
          diff *= -1;

          this.moveCardEls(diff);
        };

        // create parallax effect on card elements sliding them
        Slider.prototype.moveCardEls = function (diff) {
          var card = this.cards[this.currentIndex];

          var cardLogo = card.querySelector(".card__logo");
          var cardTitle = card.querySelector(".card__title");
          var cardSubtitle = card.querySelector(".card__subtitle");
          var cardImage = card.querySelector(".card__image");
          var cardWillAnimate = card.querySelectorAll(".card__will-animate");

          cardLogo.style.transform = "translateX(" + diff / this.ratio + "px)";

          cardTitle.style.transform =
            "translateX(" + diff / (this.ratio * 0.9) + "px)";
          cardSubtitle.style.transform =
            "translateX(" + diff / (this.ratio * 0.85) + "px)";

          cardImage.style.transform =
            "translateX(" + diff / (this.ratio * 0.35) + "px)";
        };

        // create slider
        var slider = new Slider();
      })();
    </script>

    <!-- Firebase Config -->
    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-app.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-analytics.js";
      // TODO: Add SDKs for Firebase products that you want to use
      // https://firebase.google.com/docs/web/setup#available-libraries

      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: "AIzaSyAKothMDxyl6fKgYhMnyNHkHGOy8l6ObrE",
        authDomain: "medal-landing-page.firebaseapp.com",
        projectId: "medal-landing-page",
        storageBucket: "medal-landing-page.appspot.com",
        messagingSenderId: "655123622979",
        appId: "1:655123622979:web:c29ca8805fbb0f9faeb8f6",
        measurementId: "G-HC662FM87X",
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);
    </script>
  </body>
</html>
